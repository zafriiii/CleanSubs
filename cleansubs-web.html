<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CleanSubs Web</title>
  <style>
    html { background:#121212; height:100%; }
    body { background:#121212; color:#e5e5e5; font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; min-height:100vh; }
    input, select { background:#1e1e1e; color:#e5e5e5; border:1px solid #333; padding:6px; margin:6px 0; }
    button { padding:10px 16px; background:#333; color:#e5e5e5; border:1px solid #555; cursor:pointer; }
    button:hover { background:#444; }
    textarea { width:100%; height:200px; background:#1e1e1e; color:#e5e5e5; border:1px solid #333; }
    .output { white-space:pre-wrap; background:#1e1e1e; color:#e5e5e5; padding:12px; margin-top:16px; border:1px solid #333; }
  </style>
</head>
<body>
  <h1>CleanSubs</h1>
  
  <p>Upload an SRT file:</p>
  <input type="file" id="srtFile" accept=".srt" />
  <textarea id="srtInput" style="display:none"></textarea>

  <p>Classification:</p>
  <select id="classification">
    <option value="U">U</option>
    <option value="P12 & 13">P12 & 13</option>
    <option value="16 & 18">16 & 18</option>
  </select>

  <p>Movie start time (HH:MM:SS):</p>
  <input type="text" id="movieStart" value="00:00:00" />

  <br /><br />
  <button onclick="scanSRT()">Scan</button>

  <div id="output" class="output"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const fileInput = document.getElementById('srtFile');
      const srtBox = document.getElementById('srtInput');
      fileInput.addEventListener('change', async e => {
        const file = e.target.files[0];
        if (!file) return;
        const text = await file.text();
        srtBox.value = text;
      });
    });

    const PROFANITY_LISTS = {
      "U": ["MOTHERFUCKER", "FATHERFUCKER", "FUCK", "FUCKED", "FUCKER", "FUCKING", "FUCKTARD", "BITCH",
        "SON OF A BITCH", "BIATCH", "BASTARD", "BALLS", "CUNT", "DICK", "DICKHEAD", "ASSHOLE", "ARSEHOLE",
        "COCK", "BLOW JOB", "HANDJOB", "BONER", "FELLATIO", "FELTCH", "HARD ON", "JIZZ", "RIMJOB", "CUNNILINGUS",
        "MASTURBATE", "ERECTION", "CAMELTOE", "PUSSY", "SLUT", "HOE", "WHORE", "BUTTHOLE", "SHITHOLE",
        "CRAPHOLE", "SUCK", "BALLOCKS", "NUTS", "NUTSACK", "BEANBAG", "TITS", "BOOBS", "PENIS", "VAGINA",
        "TESTICLE", "SCROTUM", "BREAST", "BUTTOCKS", "BUM", "SUCKER", "BASTARDS", "ASSHOLES", "BITCHES"],
      "P12 & 13": ["MOTHERFUCKER", "FATHERFUCKER", "FUCK", "FUCKED", "FUCKER", "FUCKING", "FUCKTARD",
        "BITCH", "SON OF A BITCH", "BIATCH", "BASTARD", "BALLS", "CUNT", "DICK", "DICKHEAD", "ASSHOLE",
        "ARSEHOLE", "COCK", "BLOW JOB", "HANDJOB", "BONER", "FELLATIO", "FELTCH", "HARD ON", "JIZZ",
        "RIMJOB", "CUNNILINGUS", "MASTURBATE", "ERECTION", "CAMELTOE", "PUSSY", "WANKER", "JERK OFF",
        "JERKING", "WANKING", "SUCK", "SUCKER", "BASTARDS", "ASSHOLES", "BITCHES"],
      "16 & 18": ["MOTHERFUCKER", "FATHERFUCKER", "FUCK", "FUCKED", "FUCKER", "FUCKING", "FUCKTARD",
        "BITCH", "SON OF A BITCH", "BIATCH", "BASTARD", "BALLS", "CUNT", "DICK", "DICKHEAD", "ASSHOLE",
        "ARSEHOLE", "COCK", "BLOW JOB", "HANDJOB", "BONER", "FELLATIO", "FELTCH", "HARD ON", "JIZZ",
        "RIMJOB", "CUNNILINGUS", "MASTURBATE", "ERECTION", "PUSSY", "WANKER", "JERK OFF", "JERKING",
        "WANKING", "SUCK", "SUCKER", "BASTARDS", "ASSHOLES", "BITCHES"]
    };

    function parseTimeToSeconds(t) {
      try {
        const [h, m, s] = t.split(':').map(Number);
        return h * 3600 + m * 60 + s;
      } catch {
        return null;
      }
    }

    function secondsToTime(sec) {
      sec = sec % 86400;
      const h = String(Math.floor(sec / 3600)).padStart(2, '0');
      const m = String(Math.floor((sec % 3600) / 60)).padStart(2, '0');
      const s = String(sec % 60).padStart(2, '0');
      return `${h}:${m}:${s}`;
    }

    function findProfanity(text, list) {
      const clean = text.toUpperCase();
      return list.some(w => new RegExp(`\\b${w.replace(/S$/, '')}S?\\b`).test(clean));
    }

    function scanSRT() {
      const srt = document.getElementById('srtInput').value.trim();
      const classification = document.getElementById('classification').value;
      const movieStart = document.getElementById('movieStart').value;

      const output = document.getElementById('output');
      output.textContent = '';

      if (!srt) {
        output.textContent = 'No SRT content detected.';
        return;
      }

      const movieStartSec = parseTimeToSeconds(movieStart);
      if (movieStartSec == null) {
        output.textContent = 'Invalid start time format.';
        return;
      }

      const profanityList = PROFANITY_LISTS[classification];
      const blocks = srt.split(/\n\n+/);
      const flagged = [];

      for (const block of blocks) {
        const lines = block.split(/\n+/);
        if (lines.length < 2) continue;

        const text = lines.slice(2).join(' ');
        if (findProfanity(text, profanityList)) {
          const timeLine = lines[1];
          const start = timeLine.split(' --> ')[0];
          const startSec = parseTimeToSeconds(start.split(',')[0]);
          const abs = startSec != null ? secondsToTime(movieStartSec + startSec) : 'Unknown';
          flagged.push({ block, abs });
        }
      }

      if (flagged.length === 0) {
        output.textContent = 'No profanities found.';
        return;
      }

      let out = `Found ${flagged.length} entries:\n\n`;
      flagged.forEach((f, i) => {
        out += `${i + 1}. At ${f.abs}:\n${f.block}\n--------------------------------\n`;
      });

      output.textContent = out;
    }
  </script>
  <br><br>
  <div style="margin-top:40px; font-size:12px; color:#888; line-height:1.4;">
    <p><strong>Disclaimer:</strong> This website and its tools are not associated with TM One. Any use during working hours is your own responsibility. CleanSubs was created independently by a former staff member "Zafri Wahab" and is entirely separate from any corporate entity. </p>
  </div>
</body>
</html>
